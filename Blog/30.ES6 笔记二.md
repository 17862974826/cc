# ES6 笔记二
[ES6 笔记一](https://github.com/ccforward/cc/issues/30)

[思维导图](http://naotu.baidu.com/file/e12e2639ddc6580a75f9942556d35ffb)

## 1. 函数
### 1.1 函数参数默认值

* 基本用法

	```js
	function log(x, y='Worlds'){
		console.log(x,y)
	}
	log('Hello'); // Hello, World
	
	function Poin(x=0,y=0){
		this.x = x;
		this.y = y;
	}
	
	var p = new Point();
	p // {x:0, y:0}
	```

	参数变量是默认声明的，不能用 `let` `const` 再次声明

	```js
	function foo(x = 1){
		let x = 2; // error
		const x = 3; // error
	}
	```

* 与解构赋值默认值结合使用
	
	```js
	function fetch(url, {method='GET'}={}){
		console.log(method)
	}
	fetch('/index.html') // 'GET'
	
	function m({x=0,y=0}={}){
		console.log([x,y])
	}
	
	m() // [0,0]
	m({x:1, y:2}) // [1,2]
	m({x:3}) // [3,0]
	m({}) // [0,0]
	m({xx:1}) // [0,0]
	```

* 参数默认值位置

	通常把函数的尾参数作为有默认值的参数。因为这样比较容易看出到底忽略那些参数。
	
	```js
	function f(x,y=1,z){
		console.log([x,y,z])
	}
	
	f() // [undefined, 1, undefined]
	f(1) // [1, 1, undefined]
	f(1,,2) // 出错
	f(1,undefined,3) // [1, 1, 3]
	```
	上面的函数，有默认值的参数不是尾参数，因此无法省略该参数而不省略其后的参数，除非显式的输入 undefined

* 函数`length`属性

	指定了默认值后函数的 `length` 属性将返回没有指定默认值的参数个数
	
	```js
	(function(a){}).length // 1
	(function(a,b,c=1){}).length //2
	```
	PS: rest参数不会计入 length 属性
	
* 作用域
	
	如果参数默认值是一个变量，则该变量所处的作用域与其它变量的作用域规则是一样的，即先是当前函数的作用域，然后才是全局作用域。
	
	```js
	var x = 1;
	function f(x, y=x){
		console.log(y)
	}
	f(2)  // 2
	```
	由于函数作用域内部的变量 x 已经生成所以 y 等于参数 x 而不是全局变量x。
	
	```js
	let x = 1;
	function f(y=x){
		let x= 2;
		console.log(y)
	}
	f() // 1
	```
	上述代码函数调用时 y 的默认值变量 x 尚未在函数内部生成，所以 x 指向全局变量。
	
	**如果函数A的默认值是函数B**  
	那么由于函数的作用域是其生命时的作用域，函数B的作用域就不是函数A，而是全局作用域。如下：
	
	```js
	let foo = 'outer';
	
	function bar(func = x => foo){
		let foo = 'inner';
		console.log(func());
	}
	bar(); // outer
	```
	
	上述代码等同于
	
	```js
	let foo = 'outer';
	let f = x => foo;
	
	function bar(func = f) {
	  let foo = 'inner';
	  console.log(func()); 
	}
	
	bar(); // outer
	```

* 应用

	可指定函数某一个参数不得省略，省略就会抛出错误
	
	```js
	function throwIfMissing() {
	  throw new Error('Missing parameter');
	}
	
	function foo(mustBeProvided = throwIfMissing()) {
	  return mustBeProvided;
	}
	
	foo()
	// Error: Missing parameter
	```
	上述代码可知参数 `mustBeProvided` 的默认值等于 `throwIfMissing` 函数的运行结果。这说明函数参数的默认值不是在定义时执行，而是在运行时执行。
	
	如果把函数参数默认值设置为 `undefined` 则表示这个参数是可以省略的。

